import{a as d,b as I}from"./chunk-JSWKQIWH.js";import{H as p,K as n,N as m,P as f,Q as i,f as h,lb as l,mb as u,ob as g,u as c}from"./chunk-3KDDWWSS.js";var x=new m("Browser Storage",{providedIn:"root",factory:()=>localStorage}),s="access_token";var a=(()=>{let t=class t{constructor(e){this.storage=e}get(e){return this.storage.getItem(e)}set(e,o){this.storage.setItem(e,o)}remove(e){this.storage.removeItem(e)}};t.\u0275fac=function(o){return new(o||t)(f(x))},t.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var E=new l(()=>!1),O=()=>new u().set(E,!0),H=(r,t)=>{let v=i(a);if(r.context.get(E)){let e=v.get(s);if(e){let o=r.clone({headers:r.headers.set("Authorization",`Bearer ${e}`)});return t(o)}}return t(r)};var L=(()=>{let t=class t{constructor(){this.http=i(g),this.storage=i(a),this.handle=i(I),this.apiUrl=`${d}/auth`,this.userProfileObs=new h(null),this.profile$=this.userProfileObs.asObservable()}login(e,o){return this.http.post(`${this.apiUrl}/login`,{email:e,password:o}).pipe(p(T=>this.storage.set(s,T.access_token)),c(this.handle.handleErr()))}getProfile(){return this.http.get(`${this.apiUrl}/profile`,{context:O()}).pipe(p(e=>this.emit(e)),c(this.handle.handleErr()))}logout(){this.storage.remove(s),this.emit(null)}emit(e){this.userProfileObs.next(e)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();export{s as a,a as b,H as c,L as d};
